# ğŸ—ï¸ æŠ€è¡“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è©³ç´°

## ğŸ“‹ ç›®æ¬¡

1. [ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
2. [ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè©³ç´°](#ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè©³ç´°)
3. [ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«](#ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«)
4. [APIçµ±åˆ](#apiçµ±åˆ)
5. [ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–](#ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–)
6. [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£](#ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£)
7. [æ‹¡å¼µæ€§ãƒ»ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£](#æ‹¡å¼µæ€§ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£)

---

## ğŸ¯ ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³

æœ¬ã‚·ã‚¹ãƒ†ãƒ ã¯ä»¥ä¸‹ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™:

1. **ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãƒ»ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**: é †æ¬¡å‡¦ç†ãƒ•ãƒ­ãƒ¼
2. **ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹é¢¨è¨­è¨ˆ**: ç–çµåˆãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
3. **ã‚¤ãƒ™ãƒ³ãƒˆãƒ‰ãƒªãƒ–ãƒ³**: Git pushãƒˆãƒªã‚¬ãƒ¼ã®CI/CD
4. **é™çš„ã‚µã‚¤ãƒˆç”Ÿæˆï¼ˆSSGï¼‰**: Jamstackã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Presentation Layer (Frontend)          â”‚
â”‚  - Astro Static Site                           â”‚
â”‚  - Tailwind CSS Styling                        â”‚
â”‚  - TypeScript Type Safety                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ HTML/CSS/JS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Content Layer (Markdown)             â”‚
â”‚  - Astro Content Collections                   â”‚
â”‚  - MDX Support                                 â”‚
â”‚  - Frontmatter Metadata                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ File System
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Processing Layer (Automation)           â”‚
â”‚  - Whisper Transcription                       â”‚
â”‚  - Claude Classification                       â”‚
â”‚  - Perplexity Research                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ API Calls
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          AI Services Layer (External)          â”‚
â”‚  - Anthropic Claude API                        â”‚
â”‚  - Perplexity AI API                           â”‚
â”‚  - Hugging Face Models                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ HTTP/REST
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Infrastructure Layer (GitHub)           â”‚
â”‚  - GitHub Actions (CI/CD)                      â”‚
â”‚  - GitHub Pages (Hosting)                      â”‚
â”‚  - GitHub Repository (Version Control)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§© ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè©³ç´°

### 1. Whisper Transcription Component

**æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯:**
- ãƒ¢ãƒ‡ãƒ«: `kotoba-tech/kotoba-whisper-v2.0`
- ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯: Hugging Face Transformers
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: PyTorch

**ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£:**
```python
class WhisperProcessor:
    def __init__(self, config: TranscriptionConfig):
        self.model_name = config.model_name
        self.device = self._detect_device(config.device)
        self.processor = WhisperProcessor.from_pretrained(self.model_name)
        self.model = WhisperForConditionalGeneration.from_pretrained(
            self.model_name
        ).to(self.device)

    async def transcribe(self, audio_path: Path) -> TranscriptionResult:
        """
        éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ–‡å­—èµ·ã“ã—

        Process:
        1. éŸ³å£°èª­ã¿è¾¼ã¿ï¼ˆlibrosaï¼‰
        2. å‰å‡¦ç†ï¼ˆãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã€æ­£è¦åŒ–ï¼‰
        3. ãƒ¢ãƒ‡ãƒ«æ¨è«–ï¼ˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆå˜ä½ï¼‰
        4. å¾Œå‡¦ç†ï¼ˆä¿¡é ¼åº¦è¨ˆç®—ã€æ•´å½¢ï¼‰

        Returns:
            TranscriptionResult with text and confidence
        """
        # éŸ³å£°èª­ã¿è¾¼ã¿
        audio, sr = librosa.load(audio_path, sr=16000)

        # å‰å‡¦ç†
        inputs = self.processor(
            audio,
            sampling_rate=16000,
            return_tensors="pt"
        ).to(self.device)

        # æ¨è«–
        with torch.no_grad():
            predicted_ids = self.model.generate(
                inputs.input_features,
                language="ja",
                task="transcribe"
            )

        # ãƒ‡ã‚³ãƒ¼ãƒ‰
        transcription = self.processor.batch_decode(
            predicted_ids,
            skip_special_tokens=True
        )[0]

        # ä¿¡é ¼åº¦è¨ˆç®—
        confidence = self._calculate_confidence(predicted_ids)

        return TranscriptionResult(
            text=transcription,
            confidence=confidence,
            segments=self._extract_segments(predicted_ids)
        )
```

**æœ€é©åŒ–ãƒã‚¤ãƒ³ãƒˆ:**
- GPUè‡ªå‹•æ¤œå‡ºï¼ˆCUDA/MPS/CPUï¼‰
- ãƒãƒƒãƒå‡¦ç†å¯¾å¿œ
- ãƒ¡ãƒ¢ãƒªåŠ¹ç‡çš„ãªã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡¦ç†
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ´»ç”¨

### 2. Claude Classification Component

**æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯:**
- API: Anthropic Claude API
- ãƒ¢ãƒ‡ãƒ«: claude-3-5-sonnet-20241022
- ãƒ—ãƒ­ãƒˆã‚³ãƒ«: REST API

**ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£:**
```python
class ClaudeClassifier:
    def __init__(self, config: ClassificationConfig):
        self.client = anthropic.Anthropic(
            api_key=os.environ["ANTHROPIC_API_KEY"]
        )
        self.model = config.model
        self.max_tokens = config.max_tokens
        self.temperature = config.temperature

    async def classify_content(
        self,
        content: str
    ) -> ClassificationResult:
        """
        ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’åˆ†é¡ãƒ»æ§‹é€ åŒ–

        Process:
        1. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ§‹ç¯‰
        2. Claude APIå‘¼ã³å‡ºã—
        3. æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿æŠ½å‡º
        4. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

        Returns:
            ClassificationResult with category, title, summary, tags
        """
        system_prompt = self._build_system_prompt()
        user_prompt = self._build_user_prompt(content)

        # Claude APIå‘¼ã³å‡ºã—
        message = await self.client.messages.create(
            model=self.model,
            max_tokens=self.max_tokens,
            temperature=self.temperature,
            system=system_prompt,
            messages=[
                {"role": "user", "content": user_prompt}
            ]
        )

        # æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿æŠ½å‡º
        response_text = message.content[0].text
        structured_data = self._parse_response(response_text)

        # ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
        validated_data = self._validate_classification(structured_data)

        return ClassificationResult(**validated_data)

    def _build_system_prompt(self) -> str:
        """ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ§‹ç¯‰"""
        return """
        ã‚ãªãŸã¯å„ªã‚ŒãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„åˆ†é¡ãƒ»æ§‹é€ åŒ–ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚

        ä»¥ä¸‹ã®ã‚«ãƒ†ã‚´ãƒªã«åˆ†é¡ã—ã¦ãã ã•ã„:
        - insight: ãƒ“ã‚¸ãƒã‚¹æ´å¯Ÿã€æŠ€è¡“å­¦ç¿’ã€å°‚é–€çŸ¥è­˜
        - idea: æ–°ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ã€å°†æ¥æ§‹æƒ³ã€ä¼ç”»æ¡ˆ
        - weekly-review: é€±æ¬¡æŒ¯ã‚Šè¿”ã‚Šã€æˆé•·è¨˜éŒ²ã€ç›®æ¨™è©•ä¾¡

        ä»¥ä¸‹ã®å½¢å¼ã§JSONå‡ºåŠ›ã—ã¦ãã ã•ã„:
        {
          "category": "insight",
          "title": "é­…åŠ›çš„ãªã‚¿ã‚¤ãƒˆãƒ«",
          "summary": "150æ–‡å­—ä»¥å†…ã®è¦ç´„",
          "priority": "high | medium | low",
          "tags": ["ã‚¿ã‚°1", "ã‚¿ã‚°2"],
          "body": "æ§‹é€ åŒ–ã•ã‚ŒãŸMarkdownæœ¬æ–‡"
        }
        """
```

**ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°:**
- Few-shot learning: åˆ†é¡ä¾‹ã®æç¤º
- Chain-of-thought: æ®µéšçš„æ€è€ƒã®èª˜å°
- Structured output: JSONå½¢å¼ã§ã®å‡ºåŠ›æŒ‡å®š

### 3. Perplexity Research Component

**æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯:**
- API: Perplexity AI API
- ãƒ¢ãƒ‡ãƒ«: llama-3.1-sonar-small-128k-online
- æ©Ÿèƒ½: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ Webæ¤œç´¢

**ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£:**
```python
class PerplexityResearcher:
    def __init__(self, config: ResearchConfig):
        self.api_key = os.environ["PERPLEXITY_API_KEY"]
        self.model = config.model
        self.temperature = config.temperature

    async def research_content(
        self,
        content: ClassificationResult
    ) -> ResearchResult:
        """
        ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è£ä»˜ã‘èª¿æŸ»

        Process:
        1. æ¤œç´¢ã‚¯ã‚¨ãƒªç”Ÿæˆ
        2. Perplexity APIå‘¼ã³å‡ºã—
        3. æƒ…å ±æºã®ä¿¡é ¼æ€§è©•ä¾¡
        4. ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¸ã®çµ±åˆ

        Returns:
            ResearchResult with enhanced content and sources
        """
        # æ¤œç´¢ã‚¯ã‚¨ãƒªç”Ÿæˆ
        queries = self._generate_research_queries(content)

        # ä¸¦åˆ—æ¤œç´¢
        research_tasks = [
            self._search_query(query)
            for query in queries
        ]
        results = await asyncio.gather(*research_tasks)

        # æƒ…å ±æºè©•ä¾¡
        evaluated_sources = self._evaluate_sources(results)

        # ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å¼·åŒ–
        enhanced_content = self._enhance_content(
            content,
            evaluated_sources
        )

        return ResearchResult(
            enhanced_content=enhanced_content,
            sources=evaluated_sources,
            confidence=self._calculate_research_confidence(results)
        )

    def _evaluate_sources(
        self,
        results: List[SearchResult]
    ) -> List[EvaluatedSource]:
        """
        æƒ…å ±æºã®ä¿¡é ¼æ€§è©•ä¾¡

        è©•ä¾¡åŸºæº–:
        - ãƒ‰ãƒ¡ã‚¤ãƒ³ä¿¡é ¼æ€§ï¼ˆ.gov, .edu, å…¬å¼ã‚µã‚¤ãƒˆï¼‰
        - ã‚³ãƒ³ãƒ†ãƒ³ãƒ„é®®åº¦ï¼ˆå…¬é–‹æ—¥ï¼‰
        - å¼•ç”¨æ•°ãƒ»è©•åˆ¤
        """
        evaluated = []
        for result in results:
            score = 0.0

            # ãƒ‰ãƒ¡ã‚¤ãƒ³è©•ä¾¡
            if self._is_authoritative_domain(result.url):
                score += 0.4

            # é®®åº¦è©•ä¾¡
            if self._is_recent(result.published_date):
                score += 0.3

            # ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è©•ä¾¡
            if self._has_citations(result.content):
                score += 0.3

            evaluated.append(EvaluatedSource(
                url=result.url,
                title=result.title,
                snippet=result.snippet,
                credibility_score=score
            ))

        return sorted(evaluated, key=lambda x: x.credibility_score, reverse=True)
```

**ä¿¡é ¼æ€§è©•ä¾¡ãƒ­ã‚¸ãƒƒã‚¯:**
```python
AUTHORITATIVE_DOMAINS = {
    ".gov": 1.0,      # æ”¿åºœæ©Ÿé–¢
    ".edu": 0.9,      # æ•™è‚²æ©Ÿé–¢
    ".org": 0.7,      # éå–¶åˆ©å›£ä½“
    "github.com": 0.8, # æŠ€è¡“ãƒªãƒã‚¸ãƒˆãƒª
    "arxiv.org": 0.9,  # å­¦è¡“è«–æ–‡
}

RECENCY_THRESHOLD = {
    "week": 1.0,
    "month": 0.8,
    "year": 0.5,
    "older": 0.2
}
```

### 4. Git Automation Component

**æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯:**
- ãƒ©ã‚¤ãƒ–ãƒ©ãƒª: GitPython
- CLI: GitHub CLIï¼ˆgh commandï¼‰

**ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£:**
```python
class GitAutomation:
    def __init__(self, config: GitConfig):
        self.repo = git.Repo(config.repository_path)
        self.main_branch = config.main_branch
        self.auto_push = config.auto_push
        self.create_pr = config.create_pr

    async def commit_and_deploy(
        self,
        files: List[Path],
        metadata: ContentMetadata
    ) -> DeploymentResult:
        """
        Gitæ“ä½œã®è‡ªå‹•åŒ–

        Process:
        1. ãƒ–ãƒ©ãƒ³ãƒä½œæˆ
        2. ãƒ•ã‚¡ã‚¤ãƒ«è¿½åŠ 
        3. ã‚³ãƒŸãƒƒãƒˆä½œæˆ
        4. ãƒ—ãƒƒã‚·ãƒ¥
        5. PRä½œæˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

        Returns:
            DeploymentResult with commit hash and PR URL
        """
        # ãƒ–ãƒ©ãƒ³ãƒä½œæˆ
        branch_name = self._generate_branch_name(metadata)
        self.repo.git.checkout("-b", branch_name)

        # ãƒ•ã‚¡ã‚¤ãƒ«è¿½åŠ 
        for file in files:
            self.repo.index.add([str(file)])

        # ã‚³ãƒŸãƒƒãƒˆ
        commit_message = self._generate_commit_message(metadata)
        commit = self.repo.index.commit(commit_message)

        # ãƒ—ãƒƒã‚·ãƒ¥
        if self.auto_push:
            origin = self.repo.remote(name="origin")
            origin.push(branch_name)

        # PRä½œæˆ
        pr_url = None
        if self.create_pr:
            pr_url = await self._create_pull_request(
                branch_name,
                metadata
            )

        return DeploymentResult(
            commit_hash=commit.hexsha,
            branch=branch_name,
            pr_url=pr_url
        )

    def _generate_commit_message(
        self,
        metadata: ContentMetadata
    ) -> str:
        """
        æ§‹é€ åŒ–ã•ã‚ŒãŸã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”Ÿæˆ

        Format:
        ğŸ¤– Automated content: {category} - {title}

        Generated from: {source_file}
        Session: {session_id}

        ğŸ¤– Generated with Claude Code Automation
        """
        return f"""ğŸ¤– Automated content: {metadata.category} - {metadata.title}

Generated from: {metadata.source_file}
Session: {metadata.session_id}

ğŸ¤– Generated with Claude Code Automation"""
```

---

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

### ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¹ã‚­ãƒ¼ãƒ

```typescript
// digital-garden/src/content/config.ts

import { defineCollection, z } from 'astro:content';

const insightsCollection = defineCollection({
  type: 'content',
  schema: z.object({
    title: z.string(),
    description: z.string(),
    pubDate: z.coerce.date(),
    updatedDate: z.coerce.date().optional(),
    category: z.enum(['insight', 'idea', 'weekly-review']),
    tags: z.array(z.string()),
    priority: z.enum(['high', 'medium', 'low']).default('medium'),
    draft: z.boolean().default(false),
    featured: z.boolean().default(false),
  }),
});

export const collections = {
  'insights': insightsCollection,
  'ideas': ideasCollection,
  'weekly-reviews': weeklyReviewsCollection,
};
```

### Resume YAMLã‚¹ã‚­ãƒ¼ãƒ

```yaml
# data/profile.yml

profile:
  meta:
    version: '2.0'
    last_updated: '2025-10-05'
    generated_by: resume-system-v2

  personal:
    name: string
    gender: string
    birth_date: string
    age: string
    location: string
    hobbies: array<string>

  education:
    - level: string           # ä¸­å­¦æ ¡ã€é«˜æ ¡ã€å¤§å­¦
      school_name: string
      department: string
      graduation_date: string
      notes: string

  career:
    companies:
      - company_id: string
        name: string
        employment_period:
          start_date: string
          end_date: string
        position: string
        description: string
        reason_for_leaving: string

        skills: array<string>

        projects:
          - project_id: string
            title: string
            period:
              start_date: string
              end_date: string
            role: string
            team_size: string
            responsibilities: array<string>
            achievements: array<string>
```

---

## ğŸ”Œ APIçµ±åˆ

### Claude API

**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ:**
```
POST https://api.anthropic.com/v1/messages
```

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ:**
```json
{
  "model": "claude-3-5-sonnet-20241022",
  "max_tokens": 4000,
  "temperature": 0.7,
  "system": "You are a content classification assistant...",
  "messages": [
    {
      "role": "user",
      "content": "Classify this content..."
    }
  ]
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
{
  "id": "msg_...",
  "type": "message",
  "role": "assistant",
  "content": [
    {
      "type": "text",
      "text": "{\"category\": \"insight\", ...}"
    }
  ],
  "model": "claude-3-5-sonnet-20241022",
  "usage": {
    "input_tokens": 523,
    "output_tokens": 1247
  }
}
```

**ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°:**
```python
async def call_claude_with_retry(
    self,
    prompt: str,
    max_retries: int = 3
) -> str:
    """ãƒªãƒˆãƒ©ã‚¤ãƒ­ã‚¸ãƒƒã‚¯ä»˜ãAPIå‘¼ã³å‡ºã—"""
    for attempt in range(max_retries):
        try:
            return await self._call_claude(prompt)
        except anthropic.RateLimitError:
            await asyncio.sleep(2 ** attempt)  # Exponential backoff
        except anthropic.APIError as e:
            if attempt == max_retries - 1:
                raise
            logger.warning(f"API error, retrying: {e}")

    raise Exception("Max retries exceeded")
```

### Perplexity API

**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ:**
```
POST https://api.perplexity.ai/chat/completions
```

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ:**
```json
{
  "model": "llama-3.1-sonar-small-128k-online",
  "messages": [
    {
      "role": "system",
      "content": "You are a research assistant..."
    },
    {
      "role": "user",
      "content": "Research this topic: ..."
    }
  ],
  "temperature": 0.2,
  "max_tokens": 2000,
  "search_recency_filter": "month"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
{
  "id": "...",
  "model": "llama-3.1-sonar-small-128k-online",
  "choices": [
    {
      "message": {
        "role": "assistant",
        "content": "Research findings..."
      },
      "citations": [
        {
          "url": "https://...",
          "title": "...",
          "snippet": "..."
        }
      ]
    }
  ]
}
```

---

## âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### 1. Whisperæœ€é©åŒ–

**GPUæ´»ç”¨:**
```python
def _detect_device(self, preferred: str = "auto") -> str:
    """æœ€é©ãªãƒ‡ãƒã‚¤ã‚¹æ¤œå‡º"""
    if preferred != "auto":
        return preferred

    if torch.cuda.is_available():
        return "cuda"  # NVIDIA GPU
    elif torch.backends.mps.is_available():
        return "mps"   # Apple Silicon
    else:
        return "cpu"
```

**ãƒãƒƒãƒå‡¦ç†:**
```python
async def transcribe_batch(
    self,
    audio_files: List[Path],
    batch_size: int = 4
) -> List[TranscriptionResult]:
    """ãƒãƒƒãƒå‡¦ç†ã§åŠ¹ç‡åŒ–"""
    results = []
    for i in range(0, len(audio_files), batch_size):
        batch = audio_files[i:i+batch_size]
        batch_results = await asyncio.gather(*[
            self.transcribe(file) for file in batch
        ])
        results.extend(batch_results)
    return results
```

### 2. APIå‘¼ã³å‡ºã—æœ€é©åŒ–

**ä¸¦åˆ—å‡¦ç†:**
```python
async def process_multiple_contents(
    self,
    contents: List[str]
) -> List[ClassificationResult]:
    """ä¸¦åˆ—APIå‘¼ã³å‡ºã—"""
    tasks = [self.classify_content(content) for content in contents]
    return await asyncio.gather(*tasks)
```

**ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°:**
```python
from functools import lru_cache

@lru_cache(maxsize=128)
def get_cached_classification(content_hash: str) -> Optional[ClassificationResult]:
    """åˆ†é¡çµæœã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥"""
    return self._cache.get(content_hash)
```

### 3. Astroãƒ“ãƒ«ãƒ‰æœ€é©åŒ–

**è¨­å®š:**
```javascript
// astro.config.mjs
export default defineConfig({
  output: 'static',
  build: {
    inlineStylesheets: 'auto',
  },
  vite: {
    build: {
      cssCodeSplit: true,
      rollupOptions: {
        output: {
          manualChunks: {
            'vendor': ['react', 'react-dom'],
          },
        },
      },
    },
  },
});
```

**ç”»åƒæœ€é©åŒ–:**
```astro
---
import { Image } from 'astro:assets';
import heroImage from '../assets/hero.png';
---

<Image
  src={heroImage}
  alt="Hero"
  width={1200}
  height={600}
  format="webp"
  quality={80}
/>
```

---

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### 1. APIã‚­ãƒ¼ç®¡ç†

**ç’°å¢ƒå¤‰æ•°:**
```bash
# ç’°å¢ƒå¤‰æ•°ã§ç®¡ç†ï¼ˆ.envãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
ANTHROPIC_API_KEY="sk-ant-..."
PERPLEXITY_API_KEY="pplx-..."

# .envãƒ•ã‚¡ã‚¤ãƒ«ã¯.gitignoreã«è¿½åŠ 
echo ".env" >> .gitignore
```

**GitHub Secrets:**
```yaml
# GitHub Actionsç”¨
env:
  ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
  PERPLEXITY_API_KEY: ${{ secrets.PERPLEXITY_API_KEY }}
```

### 2. å…¥åŠ›æ¤œè¨¼

```python
def validate_input_file(file_path: Path) -> bool:
    """å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œè¨¼"""
    # ã‚µã‚¤ã‚ºãƒã‚§ãƒƒã‚¯
    if file_path.stat().st_size > 500 * 1024 * 1024:  # 500MB
        raise ValueError("File too large")

    # å½¢å¼ãƒã‚§ãƒƒã‚¯
    allowed_extensions = {'.mp3', '.wav', '.mp4', '.txt', '.md'}
    if file_path.suffix.lower() not in allowed_extensions:
        raise ValueError("Invalid file type")

    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
    if ENABLE_VIRUS_SCAN:
        scan_result = virus_scan(file_path)
        if not scan_result.is_clean:
            raise SecurityError("File failed security scan")

    return True
```

### 3. ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³

```python
def sanitize_content(content: str) -> str:
    """ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³"""
    # PIIï¼ˆå€‹äººè­˜åˆ¥æƒ…å ±ï¼‰é™¤å»
    if REMOVE_PII:
        content = remove_email_addresses(content)
        content = remove_phone_numbers(content)
        content = remove_credit_cards(content)

    # HTMLã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
    content = html.escape(content)

    # ä¸é©åˆ‡ãªæ–‡å­—åˆ—é™¤å»
    content = remove_profanity(content)

    return content
```

---

## ğŸš€ æ‹¡å¼µæ€§ãƒ»ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£

### 1. æ–°ã—ã„AIãƒ¢ãƒ‡ãƒ«è¿½åŠ 

```python
# automation/components/classification/new_model_classifier.py

class NewModelClassifier(BaseClassifier):
    """æ–°ã—ã„AIãƒ¢ãƒ‡ãƒ«ã®çµ±åˆ"""

    async def classify_content(self, content: str) -> ClassificationResult:
        # æ–°ã—ã„ãƒ¢ãƒ‡ãƒ«ã®ãƒ­ã‚¸ãƒƒã‚¯
        pass
```

### 2. æ–°ã—ã„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¿ã‚¤ãƒ—è¿½åŠ 

```typescript
// digital-garden/src/content/config.ts

const newCollection = defineCollection({
  type: 'content',
  schema: z.object({
    // æ–°ã—ã„ã‚¹ã‚­ãƒ¼ãƒ
  }),
});

export const collections = {
  'insights': insightsCollection,
  'ideas': ideasCollection,
  'weekly-reviews': weeklyReviewsCollection,
  'new-type': newCollection,  // è¿½åŠ 
};
```

### 3. ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°æˆ¦ç•¥

**æ°´å¹³ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°:**
- è¤‡æ•°ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ã®ä¸¦åˆ—å‡¦ç†
- ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚·ãƒ³ã‚°

**å‚ç›´ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°:**
- GPUãƒªã‚½ãƒ¼ã‚¹ã®å¢—å¼·
- ãƒ¡ãƒ¢ãƒªãƒ»CPUæ‹¡å¼µ

---

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [æ—¥ã€…ã®é‹ç”¨ã‚¬ã‚¤ãƒ‰](./DAILY_OPERATIONS_GUIDE.md)
- [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“æ§‹æˆ](./PROJECT_OVERVIEW.md)
- [APIè¨­å®šã‚¬ã‚¤ãƒ‰](./API_SETUP_GUIDE.md)

---

**æœ€çµ‚æ›´æ–°**: 2025-10-05
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 2.0
