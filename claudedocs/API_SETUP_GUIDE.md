# ğŸ”‘ APIè¨­å®šã‚¬ã‚¤ãƒ‰

## ğŸ“‹ ç›®æ¬¡

1. [å¿…è¦ãªAPI](#å¿…è¦ãªapi)
2. [Anthropic Claude APIè¨­å®š](#anthropic-claude-apiè¨­å®š)
3. [Perplexity AI APIè¨­å®š](#perplexity-ai-apiè¨­å®š)
4. [GitHubè¨­å®š](#githubè¨­å®š)
5. [ç’°å¢ƒå¤‰æ•°è¨­å®š](#ç’°å¢ƒå¤‰æ•°è¨­å®š)
6. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)

---

## ğŸ¯ å¿…è¦ãªAPI

æœ¬ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ä»¥ä¸‹ã®APIã‚­ãƒ¼ãŒå¿…è¦ã§ã™:

| API | ç”¨é€” | å¿…é ˆ/ã‚ªãƒ—ã‚·ãƒ§ãƒ³ | æ–™é‡‘ |
|-----|------|----------------|------|
| **Anthropic Claude** | ã‚³ãƒ³ãƒ†ãƒ³ãƒ„åˆ†é¡ãƒ»æ§‹é€ åŒ– | å¿…é ˆ | å¾“é‡èª²é‡‘ |
| **Perplexity AI** | äº‹å®Ÿç¢ºèªãƒ»æƒ…å ±è£œè¶³ | å¿…é ˆ | å¾“é‡èª²é‡‘ |
| **GitHub** | ãƒªãƒã‚¸ãƒˆãƒªæ“ä½œãƒ»Actions | å¿…é ˆ | ç„¡æ–™ |
| **Hugging Face** | Whisperãƒ¢ãƒ‡ãƒ« | ä»»æ„ | ç„¡æ–™ |

---

## ğŸ¤– Anthropic Claude APIè¨­å®š

### ã‚¹ãƒ†ãƒƒãƒ—1: ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ

1. **Anthropic Consoleã«ã‚¢ã‚¯ã‚»ã‚¹**
   - URL: https://console.anthropic.com/

2. **ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—**
   - ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ç™»éŒ²
   - èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›

3. **æ”¯æ‰•ã„æƒ…å ±ç™»éŒ²**
   - ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰æƒ…å ±ã‚’å…¥åŠ›
   - åˆå›ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ: $5ï¼ˆãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³æ™‚ï¼‰

### ã‚¹ãƒ†ãƒƒãƒ—2: APIã‚­ãƒ¼ç™ºè¡Œ

1. **APIã‚­ãƒ¼ä½œæˆ**
   ```
   Console â†’ Settings â†’ API Keys â†’ Create Key
   ```

2. **ã‚­ãƒ¼åè¨­å®š**
   ```
   Name: digital-garden-automation
   ```

3. **APIã‚­ãƒ¼ã‚’ã‚³ãƒ”ãƒ¼**
   ```
   sk-ant-api03-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   ```

   âš ï¸ **é‡è¦**: ã“ã®ã‚­ãƒ¼ã¯äºŒåº¦ã¨è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚å¿…ãšå®‰å…¨ãªå ´æ‰€ã«ä¿å­˜ã—ã¦ãã ã•ã„ã€‚

### ã‚¹ãƒ†ãƒƒãƒ—3: åˆ©ç”¨ãƒ—ãƒ©ãƒ³ç¢ºèª

**æ–™é‡‘ä½“ç³»ï¼ˆ2025å¹´10æœˆç¾åœ¨ï¼‰:**
```
Claude 3.5 Sonnet:
- Input:  $3.00 / 1M tokens
- Output: $15.00 / 1M tokens

ç›®å®‰:
- 1è¨˜äº‹åˆ†é¡: ç´„1,000ãƒˆãƒ¼ã‚¯ãƒ³ = $0.018
- æœˆ100è¨˜äº‹: ç´„$1.80
```

### ã‚¹ãƒ†ãƒƒãƒ—4: ä½¿ç”¨é‡ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°

```
Console â†’ Usage â†’ API Usage
```

**ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š:**
```
Settings â†’ Billing â†’ Usage Alerts
æœˆé–“ä¸Šé™ã‚’è¨­å®š: $50
```

---

## ğŸ” Perplexity AI APIè¨­å®š

### ã‚¹ãƒ†ãƒƒãƒ—1: ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ

1. **Perplexity APIãƒãƒ¼ã‚¿ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹**
   - URL: https://www.perplexity.ai/settings/api

2. **ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—**
   - Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¾ãŸã¯ãƒ¡ãƒ¼ãƒ«ã§ç™»éŒ²

3. **APIã‚¢ã‚¯ã‚»ã‚¹ç”³è«‹**
   - ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã‚’å…¥åŠ›
   - åˆ©ç”¨ç›®çš„ã‚’è¨˜è¼‰

### ã‚¹ãƒ†ãƒƒãƒ—2: APIã‚­ãƒ¼ç™ºè¡Œ

1. **APIã‚­ãƒ¼ä½œæˆ**
   ```
   Settings â†’ API â†’ Generate New API Key
   ```

2. **ã‚­ãƒ¼åè¨­å®š**
   ```
   Name: digital-garden-research
   ```

3. **APIã‚­ãƒ¼ã‚’ã‚³ãƒ”ãƒ¼**
   ```
   pplx-xxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   ```

### ã‚¹ãƒ†ãƒƒãƒ—3: åˆ©ç”¨ãƒ—ãƒ©ãƒ³é¸æŠ

**æ–™é‡‘ä½“ç³»ï¼ˆ2025å¹´10æœˆç¾åœ¨ï¼‰:**
```
Sonar Small (128K context):
- $1.00 / 1M input tokens
- $1.00 / 1M output tokens

ç›®å®‰:
- 1è¨˜äº‹èª¿æŸ»: ç´„2,000ãƒˆãƒ¼ã‚¯ãƒ³ = $0.004
- æœˆ100è¨˜äº‹: ç´„$0.40
```

### ã‚¹ãƒ†ãƒƒãƒ—4: ä½¿ç”¨é‡ç¢ºèª

```
API Dashboard â†’ Usage â†’ Monthly Usage
```

---

## ğŸ™ GitHubè¨­å®š

### ã‚¹ãƒ†ãƒƒãƒ—1: ãƒªãƒã‚¸ãƒˆãƒªè¨­å®š

1. **ãƒªãƒã‚¸ãƒˆãƒªä½œæˆï¼ˆæ¸ˆã¿ã®å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—ï¼‰**
   ```bash
   # ãƒ­ãƒ¼ã‚«ãƒ«ã§åˆæœŸåŒ–
   git init
   git remote add origin https://github.com/yourusername/personal.git
   ```

2. **GitHub Pagesã‚’æœ‰åŠ¹åŒ–**
   ```
   Repository â†’ Settings â†’ Pages
   Source: GitHub Actions
   ```

### ã‚¹ãƒ†ãƒƒãƒ—2: GitHub Secretsè¨­å®š

1. **Secretsãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹**
   ```
   Repository â†’ Settings â†’ Secrets and variables â†’ Actions
   ```

2. **APIã‚­ãƒ¼ã‚’è¿½åŠ **
   ```
   New repository secret

   Name: ANTHROPIC_API_KEY
   Secret: sk-ant-api03-xxxxx...

   Name: PERPLEXITY_API_KEY
   Secret: pplx-xxxxx...
   ```

### ã‚¹ãƒ†ãƒƒãƒ—3: GitHub CLIè¨­å®šï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

**ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«:**
```bash
# Windows (winget)
winget install --id GitHub.cli

# macOS (Homebrew)
brew install gh

# Linux (apt)
sudo apt install gh
```

**èªè¨¼:**
```bash
gh auth login
```

**ãƒˆãƒ¼ã‚¯ãƒ³è¨­å®š:**
```bash
# Personal Access Tokenä½œæˆ
GitHub â†’ Settings â†’ Developer settings â†’ Personal access tokens â†’ Generate new token

Permissions:
â˜‘ repo (Full control of private repositories)
â˜‘ workflow (Update GitHub Action workflows)

# ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç’°å¢ƒå¤‰æ•°ã«è¨­å®š
export GITHUB_TOKEN="ghp_xxxxx..."
```

---

## âš™ï¸ ç’°å¢ƒå¤‰æ•°è¨­å®š

### Windows

**æ–¹æ³•1: ã‚·ã‚¹ãƒ†ãƒ ç’°å¢ƒå¤‰æ•°**
```powershell
# PowerShellã§è¨­å®š
[System.Environment]::SetEnvironmentVariable('ANTHROPIC_API_KEY', 'sk-ant-...', 'User')
[System.Environment]::SetEnvironmentVariable('PERPLEXITY_API_KEY', 'pplx-...', 'User')
```

**æ–¹æ³•2: .envãƒ•ã‚¡ã‚¤ãƒ«**
```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«.envãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
ANTHROPIC_API_KEY=sk-ant-api03-xxxxx...
PERPLEXITY_API_KEY=pplx-xxxxx...
GITHUB_TOKEN=ghp_xxxxx...

# .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’.gitignoreã«è¿½åŠ 
echo ".env" >> .gitignore
```

**æ–¹æ³•3: Python-dotenv**
```python
# automation/utils/env_loader.py
from dotenv import load_dotenv
import os

def load_environment():
    """ç’°å¢ƒå¤‰æ•°èª­ã¿è¾¼ã¿"""
    load_dotenv()

    required_vars = [
        "ANTHROPIC_API_KEY",
        "PERPLEXITY_API_KEY"
    ]

    missing = [var for var in required_vars if not os.getenv(var)]
    if missing:
        raise EnvironmentError(f"Missing environment variables: {missing}")

    return {
        "anthropic_key": os.getenv("ANTHROPIC_API_KEY"),
        "perplexity_key": os.getenv("PERPLEXITY_API_KEY"),
        "github_token": os.getenv("GITHUB_TOKEN", "")
    }
```

### macOS/Linux

**æ–¹æ³•1: .bashrc/.zshrc**
```bash
# ~/.bashrcã¾ãŸã¯~/.zshrcã«è¿½åŠ 
export ANTHROPIC_API_KEY="sk-ant-api03-xxxxx..."
export PERPLEXITY_API_KEY="pplx-xxxxx..."
export GITHUB_TOKEN="ghp_xxxxx..."

# åæ˜ 
source ~/.bashrc  # ã¾ãŸã¯ source ~/.zshrc
```

**æ–¹æ³•2: .envãƒ•ã‚¡ã‚¤ãƒ«**
```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«.envãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
# ï¼ˆWindowsã¨åŒæ§˜ï¼‰
```

---

## ğŸ§ª å‹•ä½œç¢ºèª

### Claude APIæ¥ç¶šãƒ†ã‚¹ãƒˆ

```python
# test_claude_api.py
import anthropic
import os

def test_claude_connection():
    """Claude APIæ¥ç¶šãƒ†ã‚¹ãƒˆ"""
    try:
        client = anthropic.Anthropic(
            api_key=os.environ["ANTHROPIC_API_KEY"]
        )

        message = client.messages.create(
            model="claude-3-5-sonnet-20241022",
            max_tokens=100,
            messages=[
                {"role": "user", "content": "Hello, Claude!"}
            ]
        )

        print("âœ… Claude APIæ¥ç¶šæˆåŠŸ")
        print(f"Response: {message.content[0].text}")
        return True

    except Exception as e:
        print(f"âŒ Claude APIæ¥ç¶šå¤±æ•—: {e}")
        return False

if __name__ == "__main__":
    test_claude_connection()
```

**å®Ÿè¡Œ:**
```bash
python test_claude_api.py
```

### Perplexity APIæ¥ç¶šãƒ†ã‚¹ãƒˆ

```python
# test_perplexity_api.py
import requests
import os

def test_perplexity_connection():
    """Perplexity APIæ¥ç¶šãƒ†ã‚¹ãƒˆ"""
    try:
        url = "https://api.perplexity.ai/chat/completions"
        headers = {
            "Authorization": f"Bearer {os.environ['PERPLEXITY_API_KEY']}",
            "Content-Type": "application/json"
        }
        data = {
            "model": "llama-3.1-sonar-small-128k-online",
            "messages": [
                {
                    "role": "user",
                    "content": "What is 2+2?"
                }
            ]
        }

        response = requests.post(url, headers=headers, json=data)
        response.raise_for_status()

        print("âœ… Perplexity APIæ¥ç¶šæˆåŠŸ")
        print(f"Response: {response.json()['choices'][0]['message']['content']}")
        return True

    except Exception as e:
        print(f"âŒ Perplexity APIæ¥ç¶šå¤±æ•—: {e}")
        return False

if __name__ == "__main__":
    test_perplexity_connection()
```

**å®Ÿè¡Œ:**
```bash
python test_perplexity_api.py
```

### çµ±åˆãƒ†ã‚¹ãƒˆ

```bash
# è‡ªå‹•åŒ–ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰å®Ÿè¡Œ
python automation/run_automation.py --test-components
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:**
```
ğŸ¤– Digital Garden Automation System - Component Test

ğŸ™ï¸  Testing Whisper Transcription...
âœ… Whisper: Available (kotoba-whisper-v2.0)

ğŸ§  Testing Claude Classification...
âœ… Claude: Available (claude-3-5-sonnet-20241022)

ğŸ” Testing Perplexity Research...
âœ… Perplexity: Available (llama-3.1-sonar-small-128k-online)

ğŸ“¦ Testing Git Automation...
âœ… Git: Available (Repository: /path/to/personal)

All components operational! âœ…
```

---

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¨ãƒ©ãƒ¼1: APIã‚­ãƒ¼ãŒè¦‹ã¤ã‹ã‚‰ãªã„

**ç—‡çŠ¶:**
```
Error: ANTHROPIC_API_KEY environment variable not set
```

**å¯¾ç­–:**
```bash
# ç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
echo $ANTHROPIC_API_KEY  # macOS/Linux
$env:ANTHROPIC_API_KEY    # Windows PowerShell

# è¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆã¯å†è¨­å®š
export ANTHROPIC_API_KEY="sk-ant-..."  # macOS/Linux
$env:ANTHROPIC_API_KEY="sk-ant-..."     # Windows PowerShell
```

### ã‚¨ãƒ©ãƒ¼2: APIãƒ¬ãƒ¼ãƒˆåˆ¶é™

**ç—‡çŠ¶:**
```
Error: Rate limit exceeded (429 Too Many Requests)
```

**å¯¾ç­–:**
```python
# ãƒªãƒˆãƒ©ã‚¤ãƒ­ã‚¸ãƒƒã‚¯ã®å®Ÿè£…
import time
from tenacity import retry, stop_after_attempt, wait_exponential

@retry(
    stop=stop_after_attempt(3),
    wait=wait_exponential(multiplier=1, min=4, max=10)
)
async def call_api_with_retry():
    # APIå‘¼ã³å‡ºã—
    pass
```

### ã‚¨ãƒ©ãƒ¼3: èªè¨¼ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶:**
```
Error: Authentication failed (401 Unauthorized)
```

**å¯¾ç­–:**
```bash
# APIã‚­ãƒ¼ã®æœ‰åŠ¹æ€§ã‚’ç¢ºèª
# 1. ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã‚­ãƒ¼ãŒæœ‰åŠ¹ã‹ç¢ºèª
# 2. ã‚­ãƒ¼ã®æ¨©é™ã‚’ç¢ºèª
# 3. å¿…è¦ã«å¿œã˜ã¦æ–°ã—ã„ã‚­ãƒ¼ã‚’ç™ºè¡Œ
```

### ã‚¨ãƒ©ãƒ¼4: GitHub Actionså¤±æ•—

**ç—‡çŠ¶:**
```
Error: secrets.ANTHROPIC_API_KEY not found
```

**å¯¾ç­–:**
```bash
# GitHub Secretsã«APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
Repository â†’ Settings â†’ Secrets and variables â†’ Actions

# ç¢ºèªé …ç›®:
# âœ… ANTHROPIC_API_KEY
# âœ… PERPLEXITY_API_KEY

# è¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆã¯è¿½åŠ 
```

---

## ğŸ’° ã‚³ã‚¹ãƒˆç®¡ç†

### æœˆé–“ã‚³ã‚¹ãƒˆè©¦ç®—

**æƒ³å®šä½¿ç”¨é‡:**
```yaml
å‡¦ç†æ•°: æœˆ100è¨˜äº‹

Claude API:
  - åˆ†é¡: 100å› Ã— $0.018 = $1.80
  - åˆè¨ˆ: $1.80/æœˆ

Perplexity API:
  - èª¿æŸ»: 50å›ï¼ˆInsightã®ã¿ï¼‰ Ã— $0.004 = $0.20
  - åˆè¨ˆ: $0.20/æœˆ

ç·è¨ˆ: ç´„$2.00/æœˆ
```

### ã‚³ã‚¹ãƒˆæœ€é©åŒ–

**1. ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æ´»ç”¨**
```python
# åˆ†é¡çµæœã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥
CACHE_TTL = 24  # hours

@cached(ttl=CACHE_TTL)
def classify_content(content_hash: str):
    # åŒã˜ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯å†åˆ†é¡ã—ãªã„
    pass
```

**2. ãƒãƒƒãƒå‡¦ç†**
```python
# è¤‡æ•°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ä¸€åº¦ã«å‡¦ç†
async def process_batch(contents: List[str]):
    # ä¸¦åˆ—å‡¦ç†ã§APIå‘¼ã³å‡ºã—å‰Šæ¸›
    pass
```

**3. ä½¿ç”¨é‡ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°**
```python
def log_api_usage(api_name: str, tokens: int, cost: float):
    """APIä½¿ç”¨é‡ã‚’ãƒ­ã‚°è¨˜éŒ²"""
    logger.info(f"{api_name}: {tokens} tokens, ${cost:.4f}")
```

---

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [æ—¥ã€…ã®é‹ç”¨ã‚¬ã‚¤ãƒ‰](./DAILY_OPERATIONS_GUIDE.md)
- [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“æ§‹æˆ](./PROJECT_OVERVIEW.md)
- [æŠ€è¡“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è©³ç´°](./TECHNICAL_ARCHITECTURE.md)

---

## ğŸ”— å…¬å¼ãƒªãƒ³ã‚¯

- **Anthropic Claude**: https://console.anthropic.com/
- **Perplexity AI**: https://www.perplexity.ai/settings/api
- **GitHub API**: https://docs.github.com/en/rest
- **Hugging Face**: https://huggingface.co/kotoba-tech/kotoba-whisper-v2.0

---

**æœ€çµ‚æ›´æ–°**: 2025-10-05
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 2.0
