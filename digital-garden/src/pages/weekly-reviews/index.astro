---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Card from '../../components/Card.astro';
import { getCollection } from 'astro:content';

const weeklyReviews = (await getCollection('weekly-reviews'))
  .filter(entry => !entry.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const baseUrl = import.meta.env.BASE_URL;
---

<BaseLayout
  title="Weekly Reviews"
  description="週次振り返り - 毎週の学びと成長の記録"
>
  <div class="mb-12">
    <h1 class="text-4xl md:text-5xl font-bold mb-4 flex items-center gap-3">
      <span>📅</span>
      <span>Weekly Reviews</span>
    </h1>
    <p class="text-xl text-gray-600">
      毎週の振り返りで、継続的な成長を記録しています
    </p>
  </div>

  {weeklyReviews.length > 0 ? (
    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
      {weeklyReviews.map((entry) => (
        <Card
          title={entry.data.title}
          description={entry.data.description}
          url={`${baseUrl}/weekly-reviews/${entry.slug}/`}
          pubDate={entry.data.pubDate}
          tags={entry.data.tags}
          category={entry.data.category}
        />
      ))}
    </div>
  ) : (
    <div class="text-center py-16 bg-white rounded-lg shadow">
      <div class="text-6xl mb-4">🌱</div>
      <h3 class="text-2xl font-bold mb-4">まだWeekly Reviewsがありません</h3>
      <p class="text-gray-600">
        最初のWeekly Reviewsを追加して、ガーデンを育て始めましょう
      </p>
    </div>
  )}
</BaseLayout>
